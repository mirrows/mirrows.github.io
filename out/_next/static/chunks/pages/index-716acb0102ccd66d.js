(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(5075)}])},5075:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return u}});var o=n(5893),s=n(9008),c=n.n(s),i=n(1664),r=n.n(i),a=n(1163),l=n(7294);function u(){let[t,e]=(0,l.useState)(""),[n,s]=(0,l.useState)(""),i=(0,a.useRouter)(),u=t=>{let e=Object.keys(t).map(e=>"".concat(e,"=").concat(String(t[e]))).join("&");return e?"?".concat(e):""},d=t=>{var e;let n={};return null===(e=t.split("?")[1])||void 0===e||e.split("&").forEach(t=>{let[e,o]=t.split("=");n[e]=o}),n},h=()=>{console.log("94e6c4175265545cd4f3169f7715281726cdac02","89cdb930895bd73a69d4",location.origin),location.href="https://github.com/login/oauth/authorize".concat(u({client_id:"89cdb930895bd73a69d4",scope:"repo"}))},p=t=>{fetch("https://mess.t-n.top/mess/",{method:"POST",body:JSON.stringify({url:"https://github.com/login/oauth/access_token",method:"POST",headers:{Accept:"application/vnd.github+json"},data:{client_id:"89cdb930895bd73a69d4",client_secret:"94e6c4175265545cd4f3169f7715281726cdac02",code:t}})}).then(t=>t.json()).then(t=>{console.log(t),t.access_token&&sessionStorage.setItem("token",t.access_token),f(),i.push("/")})},f=()=>{let t={url:"https://api.github.com/user",method:"GET",headers:{Accept:"application/vnd.github+json",Authorization:"token ".concat(sessionStorage.token)}};fetch("https://mess.t-n.top/mess/",{method:"POST",body:JSON.stringify(t)}).then(t=>t.json()).then(t=>{console.log(t),t.login&&sessionStorage.setItem("userInfo",JSON.stringify(t))})};return(0,l.useEffect)(()=>{let t=d(i.asPath);if(t.code)console.log(t.code),p(t.code);else{if(!sessionStorage.token)return;f()}},[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(c(),{children:[(0,o.jsx)("title",{children:"666"}),(0,o.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,o.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,o.jsx)("link",{rel:"icon",href:"/favicon.ico"}),(0,o.jsx)("meta",{httpEquiv:"Content-Security-Policy",content:"upgrade-insecure-requests"})]}),(0,o.jsxs)("main",{children:[(0,o.jsx)("img",{src:"/github.svg",style:{width:"32px"},alt:"github",onClick:h}),(0,o.jsx)("div",{children:(0,o.jsx)(r(),{href:"/about",children:"关于我们"})})]})]})}},1163:function(t,e,n){t.exports=n(387)}},function(t){t.O(0,[996,774,888,179],function(){return t(t.s=8312)}),_N_E=t.O()}]);