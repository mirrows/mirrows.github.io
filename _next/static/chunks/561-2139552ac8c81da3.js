(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[561],{2561:function(e,t,n){"use strict";n.r(t);var r=n(7812),c=n(9499),a=n(29),i=n(4730),u=n(7794),s=n.n(u),o=n(2999),l=n(3806),f=n(7167),p=n(1575),d=n(8984),v=n(7294),_=n(931),m=n.n(_),h=n(5893),b=["list","mode","path","show","onPreview"];function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach(function(t){(0,c.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}t.default=(0,v.forwardRef)(function(e,t){var n,u,_=e.list,w=e.mode,k=void 0===w?f.VD.PHOTO:w,g=e.path,j=void 0===g?"normal/":g,P=e.show,y=void 0===P||P,O=e.onPreview,Z=(0,i.Z)(e,b),L=(0,v.useState)(!1),N=L[0],C=L[1],R=(0,v.useState)((void 0===_?[]:_)||[]),S=R[0],E=R[1],D=(0,v.useState)({}),I=D[0],T=D[1],V=(0,v.useRef)(0),G=(0,v.useRef)(1),z=(0,v.useRef)({}),A=(0,p.XA)(),F=(0,v.useRef)(Math.random()),H=(0,v.useRef)(!1),M=(0,v.useState)(!1),U=M[0],X=M[1],Y=(0,v.useState)(""),q=Y[0],B=Y[1],K=(0,v.useRef)(),Q=(0,v.useRef)(null),J=(0,v.useState)(""),W=J[0],$=J[1],ee=(0,v.useState)(""),et=ee[0],en=ee[1];(0,v.useRef)();var er=(0,v.useCallback)((n=(0,a.Z)(s().mark(function e(t){var n,r,a;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n="","number"==typeof t?n=null===(r=S[t])||void 0===r?void 0:r.path:"string"==typeof t&&(n=t),n){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,(0,f.Zb)(n,k).catch(function(){});case 6:return a=e.sent,B(""),T(function(e){return x(x({},e),{},(0,c.Z)({},n,(null==a?void 0:a.data)||(null==e?void 0:e[n])||[]))}),e.abrupt("return",(null==a?void 0:a.data)||[]);case 10:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),[S,k]),ec=(0,v.useCallback)((0,a.Z)(s().mark(function e(){var t;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.Zb)(j,k);case 2:return t=e.sent.data,e.next=6,new Promise(function(e){setTimeout((0,a.Z)(s().mark(function n(){return s().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:E(t),e(t);case 2:case"end":return n.stop()}},n)})))});case 6:case"end":return e.stop()}},e)})),[j,k]),ea=(0,v.useCallback)((0,a.Z)(s().mark(function e(){var t;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:V.current+=1,t=0;case 2:if(!(t<G.current)){e.next=8;break}return e.next=5,er(t+G.current*(V.current-1));case 5:t++,e.next=2;break;case 8:S.length<=V.current*G.current&&X(!0);case 9:case"end":return e.stop()}},e)})),[null==S?void 0:S.length,er]),ei=function(e,t){(0,f.Is)({path:t.path,sha:t.sha,mode:k}).then(function(n){Q.current&&(null===(r=K.current)||void 0===r||r.unobserve(Q.current));var r,a=I[e].filter(function(e){return e.sha!==t.sha});z.current[e]=a,e===q&&1===a.length&&B(""),T(x(x({},I),{},(0,c.Z)({},e,a))),setTimeout(function(){var e;Q.current&&(null===(e=K.current)||void 0===e||e.observe(Q.current))})})};(0,v.useImperativeHandle)(t,function(){var e;return{afterUpload:(e=(0,a.Z)(s().mark(function e(){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ec();case 2:B(0);case 3:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)})}});var eu=function(e,t){null==O||O(e,t)};(0,v.useCallback)((0,a.Z)(s().mark(function e(){var t,n,c;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=Object.keys(I),n=s().mark(function e(n){var c,a;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=t[n],e.next=3,(0,f.Zb)(c,k);case 3:a=e.sent,T(function(e){return z.current[c]=(0,r.Z)(e[c].map(function(e){return x(x({},e),(null==a?void 0:a.data.find(function(t){return t.name===e.name}))||{})})),x({},z.current)});case 5:case"end":return e.stop()}},e)}),c=0;case 3:if(!(c<t.length)){e.next=8;break}return e.delegateYield(n(c),"t0",5);case 5:c++,e.next=3;break;case 8:case"end":return e.stop()}},e)})),[k,I]);var es=(u=(0,a.Z)(s().mark(function e(t){var n;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.Zb)(t,k);case 2:n=e.sent,T(function(e){return z.current[t]=(0,r.Z)(e[t]?e[t].map(function(e){return x(x({},e),(null==n?void 0:n.data.find(function(t){return t.name===e.name}))||{})}):null==n?void 0:n.data),x({},z.current)});case 4:case"end":return e.stop()}},e)})),function(e){return u.apply(this,arguments)}),eo=function(e,t){T(function(n){return z.current[e]=(0,r.Z)(n[e].map(function(e,n){return x(x({},e),{},{loaded:n===t||e.loaded||!1})})),x({},z.current)})};(0,v.useEffect)(function(){""!==q&&er(q)},[q,er]),(0,v.useEffect)(function(){H.current||(H.current=!0,ec())},[ec]),(0,v.useEffect)(function(){if(null!=S&&S.length&&"private"!==k){K.current=new IntersectionObserver((e=(0,a.Z)(s().mark(function e(t){var n,r;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t[0].intersectionRatio<=0)){e.next=2;break}return e.abrupt("return");case 2:return Q.current&&(null===(n=K.current)||void 0===n||n.unobserve(Q.current)),e.next=5,ea();case 5:Q.current&&(null===(r=K.current)||void 0===r||r.observe(Q.current));case 6:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}),{rootMargin:"500px 0px"}),Q.current&&(null===(t=K.current)||void 0===t||t.observe(Q.current));var e,t,n=Q.current;return function(){var e,t;n&&(null===(e=K.current)||void 0===e||e.unobserve(n)),null===(t=K.current)||void 0===t||t.disconnect()}}},[null==S?void 0:S.length,k]),(0,v.useEffect)(function(){if(y)Q.current&&(null===(e=K.current)||void 0===e||e.observe(Q.current));else{Q.current&&(null===(t=K.current)||void 0===t||t.unobserve(Q.current));return}var e,t,n=Q.current;return function(){var e,t;n&&(null===(e=K.current)||void 0===e||e.unobserve(n)),null===(t=K.current)||void 0===t||t.disconnect()}},[y]);var el=(0,v.useCallback)(function(e){return"#".concat(String(F.current*(e+4)).slice(4,7))},[]);return(0,v.useEffect)(function(){d.SR.isGithubOwner(function(e){return C(e)})},[]),(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("div",x(x({},Z),{},{children:(0,h.jsxs)("div",{className:m().picList,children:[(0,h.jsx)("div",{className:m().list_wrap,children:null==S?void 0:S.map(function(e,t){var n,r;return null!==(n=I[e.path])&&void 0!==n&&n.length?(0,h.jsxs)("div",{className:"".concat(m().time_fold_wrap).concat(V.current*G.current>t||"private"===k?"":" hide"),children:["private"!==k?(0,h.jsxs)("div",{className:m().timestone,onClick:function(){e.name===et||es(e.path),en(e.name===et?"":e.name)},children:[N&&(0,h.jsx)("input",{type:"checkbox",checked:e.name===W,className:m().if_del_btn,onChange:function(t){$(t.target.checked?e.name:"")}}),e.name]}):"","private"!==k||e.name===et?(0,h.jsx)("div",{className:m().pics_item_wrap,children:null===(r=I[e.path])||void 0===r?void 0:r.map(function(t,n){return(0,h.jsxs)("div",{className:m().pic_item_wrap,style:{backgroundColor:el(n)},children:[W===e.name&&(0,h.jsx)(l.Z,{className:m().img_del_btn,type:"close",onClick:function(){return ei(e.path,t)}}),(0,h.jsx)(o.Z,{className:m().img_item,src:"https://wsrv.nl/?url=".concat((t.download_url||"").replace("https://","")).concat(A?"&w=80&h=180":"&w=300","&fit=cover&n=-1&q=80"),width:"130",height:"320",noReload:!0,onLoad:function(t){eo(e.path,n)},onClick:function(){return eu(I[e.path],n)}})]},t.name)})}):""]},e.path):""})}),"private"===k?(0,h.jsx)("div",{className:m().float_tabs_wrap,children:null==S?void 0:S.map(function(e,t){return(0,h.jsx)("div",{className:"".concat(m().time_fold_wrap),children:(0,h.jsxs)("div",{className:"".concat(m().timestone," ").concat(e.name===et?m().timestone_active:""),onClick:function(){e.name===et||es(e.path),en(e.name)},children:[N&&(0,h.jsx)("input",{type:"checkbox",checked:e.name===W,className:m().if_del_btn,onChange:function(t){$(t.target.checked?e.name:"")}}),e.name]})},e.path)})}):"","private"!==k?(0,h.jsx)("div",{ref:Q,children:U||!S?(0,h.jsx)("div",{className:m().no_more_tips,children:"真的一点都没有了。。。。。。"}):(0,h.jsx)(l.Z,{className:"".concat(m().load_more_sign," rotate"),width:"48",type:"loading",fill:"gray"})}):""]})}))})})},931:function(e){e.exports={picList:"PicList_picList__jiYUh",list_wrap:"PicList_list_wrap__2VsET",timestone:"PicList_timestone__zV1PX",time_fold_wrap:"PicList_time_fold_wrap__VGrwI",pics_item_wrap:"PicList_pics_item_wrap__xNoG8",img_item:"PicList_img_item__2dbAk",pic_item_wrap:"PicList_pic_item_wrap__mvLm5",img_del_btn:"PicList_img_del_btn__c9pjr",no_more_tips:"PicList_no_more_tips__Zrved",if_del_btn:"PicList_if_del_btn__Lm0pV",float_tabs_wrap:"PicList_float_tabs_wrap__KIfBO",timestone_active:"PicList_timestone_active__z9TFQ"}}}]);