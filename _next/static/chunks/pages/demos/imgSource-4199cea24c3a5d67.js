(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[205],{8888:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSG:function(){return Z},default:function(){return P}});var r=n(29),i=n(7794),o=n.n(i),a=n(9499),c=n(7812),s=n(4730),l=n(7167),u=n(7989),p=n(3290),d=n(7294),f=n(9521),m=n(3806),h=n(2379),g=n(2999);n(995);var x=n(5893),b=f.ZP.div.withConfig({displayName:"PicModal__PIC",componentId:"sc-l89lay-0"})(["&.imgs_wrap{position:fixed;top:0;bottom:0;left:0;right:0;background-color:#666;z-index:60;}.pic_wrap{display:flex;justify-content:center;align-items:center;padding:30px;margin:auto;box-sizing:border-box;}.pic_item{width:unset;height:unset;max-width:100%;max-height:100%;}.swiper_header{display:flex;flex-wrap:nowrap;justify-content:space-between;align-items:center;position:absolute;top:0;left:0;width:100%;height:fit-content;padding:10px;background-image:linear-gradient(black 0%,transparent 80%);box-sizing:border-box;color:#fff;z-index:80;.name{line-height:1;}}.modal_wrap{}.img_swiper_wrap{width:100%;height:100%;}.img_swiper_wrap .tmp_status_btn{position:absolute;width:64px;z-index:-1;}"]),_=(0,d.forwardRef)(function(e,t){var n,r=e.pics,i=(0,d.useState)(!1),o=i[0],a=i[1],c=(0,d.useRef)(null),s=(0,d.useState)(0),l=s[0],f=s[1],_=(0,d.useState)(!1),w=_[0],v=_[1],y=(0,p.wo)(".img_swiper_wrap .lazy").emit,j=(0,d.useState)(r||[]),k=j[0],N=j[1],S=(0,d.useState)(!1),O=S[0],E=S[1],R=(0,d.useRef)({obj:"body",val:0}),Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;N(e),f(t),E(!0),c.current?(c.current.slideTo(t),a(!0)):setTimeout(function(){var e;null===(e=c.current)||void 0===e||e.slideTo(t),a(!0)})},P=function(){N([]),a(!1)};return(0,d.useImperativeHandle)(t,function(){return{open:Z,close:P}}),(0,d.useEffect)(function(){r&&N(r)},[r]),(0,d.useEffect)(function(){v((0,u.tq)())},[]),(0,d.useEffect)(function(){if(o)document.body.scrollTop?R.current={obj:"body",val:document.body.scrollTop}:document.documentElement.scrollTop&&(R.current={obj:"documentElement",val:document.documentElement.scrollTop}),document.body.classList.add("disabled_scroll"),y();else{if(N([]),document.body.classList.remove("disabled_scroll"),!R.current.val)return;document[R.current.obj].scrollTop=R.current.val,R.current.val=0}},[o,y]),O||o?(0,x.jsxs)(b,{className:"imgs_wrap".concat(o?"":" hide"),onScroll:function(e){e.stopPropagation()},onWheel:function(e){e.stopPropagation()},children:[(0,x.jsxs)("div",{className:"swiper_header",children:[(0,x.jsx)("span",{className:"name",children:(null===(n=k[l])||void 0===n?void 0:n.name)||""}),(0,x.jsx)(m.Z,{type:"close",width:"30",height:"30",fill:"#fff",className:"close_swiper",onClick:function(){return a(!1)}})]}),(0,x.jsx)(h.tq,{loop:!0,className:"img_swiper_wrap",onSwiper:function(e){return c.current=e},onSlideChangeTransitionEnd:function(e){f(e.realIndex),y()},children:k.map(function(e,t){return(0,x.jsx)(h.o5,{className:"pic_wrap",children:(0,x.jsx)(g.Z,{loadingPic:e.cdn_url,src:w?(null==e?void 0:e.cdn_url)||"":(null==e?void 0:e.normal_url)||(null==e?void 0:e.cdn_url)||"",className:"pic_item",width:"1920",height:"1080",alt:"bing",children:(0,x.jsx)(m.Z,{className:"tmp_status_btn rotate",type:"loading",fill:"#fff"})})},t)})})]}):(0,x.jsx)(x.Fragment,{})});_.displayName="PicModal";var w=["clickable","children","autoUpload","onStartUpload","personal","onFinish"];function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach(function(t){(0,a.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var j=f.ZP.div.withConfig({displayName:"ImgUpload__DIV",componentId:"sc-6cvirj-0"})([".mm-footer{display:flex;justify-content:space-between;align-items:center;min-height:24px;margin-top:10px;text-align:left;}.url_input_wrap{display:inline-block;position:relative;vertical-align:middle;.url_input_wrap{margin-right:10px;}.url_input{flex:1 1 0;width:100%;height:100%;padding-right:36px;box-sizing:border-box;font-size:12px;}.enter_icon{position:absolute;right:3px;top:0;bottom:0;height:12px;width:12px;padding:4px;background-color:#000;border-radius:4px;margin:auto;fill:#fff;}}.file_wrap{display:inline-block;padding:0 8px;margin:0 10px;white-space:nowrap;font-size:1rem;color:gray;}.tmp_wrap{display:flex;flex-wrap:wrap;max-height:215px;}.tmp_item_wrap{position:relative;}.tmp_item{width:40px;height:96px;object-fit:cover;margin:5px;}.tmp_del_btn{position:absolute;right:0;top:0;width:15px;padding:0 0 5px 5px;border-radius:0 0 0 20px;fill:#fff;background-color:#000;}.tmp_status_btn{position:absolute;left:5px;bottom:5px;width:20px;}.submit_btn{float:right;}"]);function k(e){var t,n,i,a,f=e.clickable,h=void 0===f||f,g=e.children,b=e.autoUpload,v=void 0!==b&&b,k=e.onStartUpload,N=e.personal,S=void 0!==N&&N,O=e.onFinish,E=void 0===O?function(){}:O,R=(0,s.Z)(e,w),Z=(0,d.useRef)(null),P=(0,d.useRef)(null),D=(0,d.useState)([]),C=D[0],I=D[1],T=(0,d.useState)([]),U=T[0],z=T[1],A=(0,d.useState)(""),L=A[0],M=A[1],G=(0,d.useState)(!1),Y=G[0],F=G[1],q=(0,d.useRef)(S),V=(0,d.useRef)(null),W=(0,d.useRef)((null===(i=window)||void 0===i?void 0:i.URL)||(null===(a=window)||void 0===a?void 0:a.webkitURL)),X=(0,d.useMemo)(function(){return[].concat((0,c.Z)(C.map(function(e){var t,n=(null===(t=W.current)||void 0===t?void 0:t.createObjectURL(e))||"";return{id:btoa(encodeURI(e.name+e.type+e.size)),type:"file",src:n}})),(0,c.Z)(U.map(function(e){return{id:e.slice(30,50),type:"url",src:e}})))},[U,C]),H=(0,d.useState)({}),K=H[0],B=H[1],J=(t=(0,r.Z)(o().mark(function e(t,n,r){var i,a,c;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.type.match("gif")&&!r.match("mini"))){e.next=4;break}e.t0=t,e.next=7;break;case 4:return e.next=6,(0,p.el)(t,n);case 6:e.t0=e.sent;case 7:return i=e.t0,e.next=10,(0,p.Uc)(i);case 10:return a=e.sent,e.next=13,(0,l.iS)({content:a.split(",")[1],path:r});case 13:return c=e.sent,e.abrupt("return",c);case 15:case"end":return e.stop()}},e)})),function(e,n,r){return t.apply(this,arguments)}),Q=(n=(0,r.Z)(o().mark(function e(t){var n,r,i,a,c,s,p,d,f,m,h;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:null==t||t.stopPropagation(),F(!0),k(),q.current=S,n=y({},K),r=0;case 6:if(!(r<C.length)){e.next=24;break}return i="pic"+Date.now()+String(Math.random()).slice(4,7)+"."+C[r].name.split(".").reverse()[0],a="".concat((0,u.ED)(new Date,"YYYY_MM_DD"),"/").concat(i),c="LOADING",n[X[r].id]=c,B(y({},n)),e.next=14,J(C[r],{quality:.1,mimeType:"image/jpeg"},"".concat(S?"personal/":"","mini/").concat(a));case 14:return s=e.sent,e.next=17,J(C[r],{quality:2097152>C[r].size?2097152/C[r].size:.8},"".concat(S?"personal/":"","normal/").concat(a));case 17:(e.sent.code||s.code)&&(c="ERROR"),n[X[r].id]="LOADING"===c?"SUCCESS":c,B(y({},n));case 21:r++,e.next=6;break;case 24:p=0;case 25:if(!(p<U.length)){e.next=43;break}return d="LOADING",n[X[p+C.length].id]=d,B(y({},n)),f="pic"+Date.now()+String(Math.random()).slice(4,7),m="".concat((0,u.ED)(new Date,"YYYY_MM_DD"),"/").concat(f),e.next=33,(0,l.P_)({url:U[p],path:"".concat(q.current?"personal/":"","mini/").concat(m)});case 33:return h=e.sent,e.next=36,(0,l.P_)({url:U[p],path:"".concat(q.current?"personal/":"","normal/").concat(m)});case 36:(e.sent.code||h.code)&&(d="ERROR"),n[X[p+C.length].id]="LOADING"===d?"SUCCESS":d,B(y({},n));case 40:p++,e.next=25;break;case 43:E(),z(function(e){return e.filter(function(e,t){return"ERROR"===n[X[t+C.length].id]})}),I(function(e){return e.filter(function(e,t){return"ERROR"===n[X[t].id]})}),P.current&&(P.current.value=""),F(!1);case 48:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),$=function(){z(function(e){return Array.from(new Set([].concat((0,c.Z)(e),(0,c.Z)(L.split(",")))))}),M("")},ee=function(e,t){"file"===e.type?I(function(e){var n=(0,c.Z)(e);return n.splice(t,1),n}):"url"===e.type&&z(function(e){var n=(0,c.Z)(e);return n.splice(t-C.length,1),n})},et=function(e){var t;null===(t=V.current)||void 0===t||t.open(X.map(function(t){return{cdn_url:t.src,sha:Date.now().toString()+e}}),e)};return(0,d.useEffect)(function(){var e=W.current;return function(){X.forEach(function(t){"file"===t.type&&t.src&&(null==e||e.revokeObjectURL(t.src))})}},[X]),(0,d.useEffect)(function(){v&&C.length&&Q(),!C.length&&P.current&&(P.current.value="")},[C,v]),(0,d.useEffect)(function(){B(function(e){var t={};return X.forEach(function(n){t[n.id]=e[n.id]||"WAIT"}),t})},[X]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(j,y(y({ref:Z},R),{},{onClick:function(){var e;h&&(null===(e=P.current)||void 0===e||e.click())},onDrop:function(e){var t;e.preventDefault(),e.stopPropagation(),(null===(t=e.dataTransfer.files)||void 0===t?void 0:t.length)&&I(function(t){return[].concat((0,c.Z)(t),(0,c.Z)(Array.from(e.dataTransfer.files)))})},onDragOver:function(e){return e.preventDefault()},children:[!!X.length||g,(0,x.jsx)("input",{ref:P,type:"file",name:"",id:"",multiple:!0,accept:"image/*",style:{display:"none"},onChange:function(e){var t;(null===(t=e.target.files)||void 0===t?void 0:t.length)&&I((0,c.Z)(Array.from(e.target.files)))}}),(0,x.jsx)("div",{className:"scroll_er tmp_wrap",children:X.map(function(e,t){return(0,x.jsxs)("div",{className:"tmp_item_wrap upload_".concat(K[e.id]),onClick:function(e){return e.stopPropagation()},children:[(0,x.jsx)("img",{className:"tmp_item",width:"40",height:"96",src:e.src,alt:"",onClick:function(){return et(t)}}),Y||(0,x.jsx)(m.Z,{className:"tmp_del_btn",type:"close",onClick:function(){return ee(e,t)}}),{SUCCESS:(0,x.jsx)(m.Z,{className:"tmp_status_btn",type:"yes",fill:"green"}),ERROR:(0,x.jsx)(m.Z,{className:"tmp_status_btn",type:"no",fill:"red"}),WAIT:"",LOADING:(0,x.jsx)(m.Z,{className:"tmp_status_btn rotate",type:"loading",fill:"gray"})}[K[e.id]]]},e.id)})}),v||(0,x.jsxs)("div",{className:"mm-footer",children:[(0,x.jsxs)("div",{className:"url_input_wrap",onClick:function(e){return e.stopPropagation()},children:[(0,x.jsx)("input",{className:"normal_input url_input",type:"text",placeholder:"".concat(X.length||0," pics will be uploaded"),value:L,onInput:function(e){return M(e.currentTarget.value)},onKeyUp:function(e){"Enter"===e.key&&$()}}),(0,x.jsx)(m.Z,{className:"enter_icon",type:"enter",onClick:$})]}),!!X.length&&(0,x.jsx)("button",{className:"normal_btn submit_btn",onClick:Q,children:"submit"})]})]})),(0,x.jsx)(_,{ref:V})]})}var N=n(8984),S=n(9008),O=n.n(S),E=n(2561),R=f.ZP.div.withConfig({displayName:"imgSource__DIV",componentId:"sc-e5jkib-0"})(["padding:80px 0;margin:0 auto;background-image:url('https://empty.t-n.top/pub_lic/2023_07_08/pic1688805979076243.jpg');text-align:center;.uploader_wrap{width:60%;min-width:200px;max-width:900px;padding:10px;margin:auto;border:2px dashed gray;border-radius:6px;background-image:url(https://empty.t-n.top/pub_lic/2023_07_08/pic1688805979076243.jpg);box-shadow:0 0 5px #999;cursor:pointer;}.tips{font-size:0.8em;color:gray;}@media (max-width:769px){.uploader_wrap{width:90%;}}.switch_wrap{margin:10px;}.switch_btn{padding:4px 20px;background-color:#fff;border:1px solid #000;font-size:1rem;color:#000;}.switch_btn.active{background-color:#000;color:#fff;}.switch_btn:hover{box-shadow:none;}"]),Z=!0;function P(){var e,t=(0,d.useState)(!1),n=t[0],i=t[1],a=(0,d.useState)(!1),c=a[0],s=a[1],l=(0,d.useRef)(null),u=(0,d.useRef)(null),p=(0,d.useRef)(!1),f=(0,d.useRef)(null),h=(e=(0,r.Z)(o().mark(function e(){var t,n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:p.current?null===(t=u.current)||void 0===t||t.afterUpload():null===(n=l.current)||void 0===n||n.afterUpload();case 1:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)}),g=function(e,t){var n;null===(n=f.current)||void 0===n||n.open(e,t)};return(0,d.useEffect)(function(){N.S.isGithubOwner(function(e){return s(e)})},[]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(O(),{children:[(0,x.jsx)("title",{children:"延迟图床"}),(0,x.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,x.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,x.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,x.jsx)("main",{children:(0,x.jsxs)(R,{className:"bg_wrap",children:[(0,x.jsx)(k,{className:"uploader_wrap",personal:n,onFinish:h,onStartUpload:function(){p.current=n},children:(0,x.jsx)("div",{children:(0,x.jsx)(m.Z,{width:"32",style:{fill:"gray"},type:"plus_no_outline"})})}),c&&(0,x.jsxs)("div",{className:"switch_wrap",children:[(0,x.jsx)("button",{className:"switch_btn".concat(n?"":" active"),onClick:function(){return i(!1)},children:"COMMON"}),(0,x.jsx)("button",{className:"switch_btn".concat(n?" active":""),onClick:function(){return i(!0)},children:"PRIVATE"})]}),(0,x.jsx)(E.default,{ref:l,list:[],path:"mini/",show:!n,className:n?"hide":"",onPreview:g}),c&&(0,x.jsx)(E.default,{ref:u,list:[],path:"personal/mini/",show:!!n,className:n?"":"hide",onPreview:g}),(0,x.jsx)(_,{ref:f})]})})]})}},5241:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/demos/imgSource",function(){return n(8888)}])},7812:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(2587),i=n(2937);function o(e){return function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,i.Z)(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}},function(e){e.O(0,[534,561,774,888,179],function(){return e(e.s=5241)}),_N_E=e.O()}]);