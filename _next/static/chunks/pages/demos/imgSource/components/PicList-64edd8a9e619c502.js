(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[932],{2999:function(e,t,n){"use strict";var r=n(9499),o=n(4730),c=n(7294),a=n(5893),i=n(3454),u=["loadingPic","src","className","beforeLoad","onLoad","noReload","children","isShow"];function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}t.Z=function(e){var t=e.loadingPic,n=e.src,l=e.className,p=(e.beforeLoad,e.onLoad),f=void 0===p?function(e){return Promise.resolve(e)}:p,d=e.noReload,m=void 0!==d&&d,h=e.children,v=e.isShow,b=void 0===v||v,g=(0,o.Z)(e,u),w=(0,c.useRef)(t||"https://wsrv.nl/?url=raw.githubusercontent.com/mirrows/photo/main/normal/2023_09_10/pic1694333133502339.gif&w=130&fit=cover&n=-1&q=80"),x=(0,c.useRef)(i.env.NEXT_FAIL_IMG),O=(0,c.useState)(w.current),y=O[0],j=O[1],_=(0,c.useState)(!1),k=_[0],P=_[1],R=(0,c.useRef)(null),S=(0,c.useRef)(0);return(0,c.useEffect)(function(){if(!S.current){var e,t,r=document.documentElement.clientHeight,o=document.documentElement.clientWidth;m||null===(e=R.current)||void 0===e||e.classList.add("lazy"),P(!1),R.current&&!(R.current.getBoundingClientRect().top<-R.current.clientHeight||R.current.getBoundingClientRect().top>1.5*r)&&!(R.current.getBoundingClientRect().left<-o||R.current.getBoundingClientRect().left>1.5*o)&&R.current.getBoundingClientRect().width&&R.current.getBoundingClientRect().height&&b&&(m&&(S.current=1),null===(t=R.current)||void 0===t||t.classList.remove("lazy"),j(n))}},[n,b,m]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({className:"".concat(l?"lazy ".concat(l):"lazy"),ref:R,src:y,"data-src":n,alt:"",onLoad:function(){var e;P(!0),n===(null===(e=R.current)||void 0===e?void 0:e.src)&&f(n)},onError:function(){var e;null===(e=R.current)||void 0===e||e.classList.add("lazy"),j(x.current),P(!0)}},g)),k||h]})}},2561:function(e,t,n){"use strict";n.r(t);var r=n(7812),o=n(9499),c=n(29),a=n(4730),i=n(7794),u=n.n(i),s=n(2999),l=n(3806),p=n(7167),f=n(7989),d=n(8984),m=n(7294),h=n(9521),v=n(5893),b=["list","mode","path","show","onPreview"];function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var x=h.ZP.div.withConfig({displayName:"PicList__DIV",componentId:"sc-tp7p0f-0"})([".list_wrap{max-width:1200px;padding:0 10px 10px;margin:10px auto;}.timestone{width:fit-content;padding:10px 20px;background-color:#000;font-size:1.2rem;color:#fff;}.time_fold_wrap{margin-bottom:10px;}.pics_item_wrap{display:grid;justify-content:center;grid-template-columns:repeat(auto-fill,130px);grid-template-rows:repeat(auto-fill,320px);gap:10px;min-width:200px;max-width:1200px;width:100%;margin:10px 0;}@media (max-width:769px){.pics_item_wrap{grid-template-columns:repeat(auto-fill,80px);grid-template-rows:repeat(auto-fill,180px);gap:5px;margin:5px 0;}.img_item{width:80px;height:180px;}}.pic_item_wrap{position:relative;}.img_del_btn{position:absolute;right:0;top:0;width:24px;padding:5px 5px 12px 12px;border-radius:0 0 0 36px;fill:#fff;background-color:#000;}.no_more_tips{font-size:2rem;font-weight:700;font-family:youyuan;letter-spacing:0.1rem;color:gray;}.if_del_btn{width:1rem;height:1rem;}"]);t.default=(0,m.forwardRef)(function(e,t){var n,i=e.list,h=e.mode,g=void 0===h?p.VD.PHOTO:h,O=e.path,y=void 0===O?"normal/":O,j=e.show,_=void 0===j||j,k=e.onPreview,P=(0,a.Z)(e,b),R=(0,m.useState)(!1),S=R[0],Z=R[1],E=(0,m.useState)((void 0===i?[]:i)||[]),N=E[0],C=E[1],D=(0,m.useState)({}),I=D[0],L=D[1],z=(0,m.useRef)(0),A=(0,m.useRef)(1),B=(0,m.useState)(!1),T=B[0],q=B[1],H=(0,m.useRef)(Math.random()),V=(0,m.useRef)(!1),F=(0,m.useState)(!1),M=F[0],X=F[1],G=(0,m.useState)(""),U=G[0],J=G[1],W=(0,m.useRef)(),Y=(0,m.useRef)(null),K=(0,m.useState)(""),Q=K[0],$=K[1],ee=(0,m.useRef)(),et=(0,m.useCallback)((n=(0,c.Z)(u().mark(function e(t){var n,r,c;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n="","number"==typeof t?n=null===(r=N[t])||void 0===r?void 0:r.path:"string"==typeof t&&(n=t),n){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,(0,p.Zb)(n,g).catch(function(){});case 6:return c=e.sent,J(""),L(function(e){return w(w({},e),{},(0,o.Z)({},n,(null==c?void 0:c.data)||(null==e?void 0:e[n])||[]))}),e.abrupt("return",(null==c?void 0:c.data)||[]);case 10:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),[N,g]),en=(0,m.useCallback)((0,c.Z)(u().mark(function e(){var t;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.Zb)(y,g);case 2:return t=e.sent.data,e.next=6,new Promise(function(e){setTimeout((0,c.Z)(u().mark(function n(){return u().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:C(t),e(t);case 2:case"end":return n.stop()}},n)})))});case 6:case"end":return e.stop()}},e)})),[y,g]),er=(0,m.useCallback)((0,c.Z)(u().mark(function e(){var t;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:z.current+=1,t=0;case 2:if(!(t<A.current)){e.next=8;break}return e.next=5,et(t+A.current*(z.current-1));case 5:t++,e.next=2;break;case 8:N.length<=z.current*A.current&&X(!0);case 9:case"end":return e.stop()}},e)})),[null==N?void 0:N.length,et]),eo=function(e,t){(0,p.Is)({path:t.path,sha:t.sha,mode:g}).then(function(t){et(e)})};(0,m.useImperativeHandle)(t,function(){var e;return{afterUpload:(e=(0,c.Z)(u().mark(function e(){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,en();case 2:J(0);case 3:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)})}});var ec=function(e,t){null==k||k(e,t)},ea=(0,m.useCallback)((0,c.Z)(u().mark(function e(){var t,n,c;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=Object.keys(I),n=u().mark(function e(n){var c,a;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(I[c=t[n]].some(function(e){return!e.loaded})){e.next=4;break}return e.abrupt("return","continue");case 4:return e.next=6,(0,p.Zb)(c,g);case 6:a=e.sent,L(function(e){return w(w({},e),{},(0,o.Z)({},c,(0,r.Z)(e[c].map(function(e){return w(w({},e),(null==a?void 0:a.data.find(function(t){return t.name===e.name}))||{})}))))});case 8:case"end":return e.stop()}},e)}),c=0;case 3:if(!(c<t.length)){e.next=11;break}return e.delegateYield(n(c),"t0",5);case 5:if("continue"!==e.t0){e.next=8;break}return e.abrupt("continue",8);case 8:c++,e.next=3;break;case 11:case"end":return e.stop()}},e)})),[g,I]),ei=function(e,t){console.log(333),L(function(n){return w(w({},n),{},(0,o.Z)({},e,(0,r.Z)(n[e].map(function(e,n){return w(w({},e),{},{loaded:n===t||e.loaded||!1})}))))})};(0,m.useEffect)(function(){""!==U&&et(U)},[U,et]),(0,m.useEffect)(function(){V.current||(V.current=!0,en())},[en]),(0,m.useEffect)(function(){if(null!=N&&N.length){W.current=new IntersectionObserver((e=(0,c.Z)(u().mark(function e(t){var n,r;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t[0].intersectionRatio<=0)){e.next=2;break}return e.abrupt("return");case 2:return Y.current&&(null===(n=W.current)||void 0===n||n.unobserve(Y.current)),e.next=5,er();case 5:Y.current&&(null===(r=W.current)||void 0===r||r.observe(Y.current));case 6:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}),{rootMargin:"500px 0px"}),Y.current&&(null===(t=W.current)||void 0===t||t.observe(Y.current));var e,t,n=Y.current;return function(){var e,t;n&&(null===(e=W.current)||void 0===e||e.unobserve(n)),null===(t=W.current)||void 0===t||t.disconnect()}}},[null==N?void 0:N.length]),(0,m.useEffect)(function(){if(_)Y.current&&(null===(e=W.current)||void 0===e||e.observe(Y.current));else{Y.current&&(null===(t=W.current)||void 0===t||t.unobserve(Y.current));return}var e,t,n=Y.current;return function(){var e,t;n&&(null===(e=W.current)||void 0===e||e.unobserve(n)),null===(t=W.current)||void 0===t||t.disconnect()}},[_]);var eu=(0,m.useCallback)(function(e){return"#".concat(String(H.current*(e+4)).slice(4,7))},[]);return(0,m.useEffect)(function(){d.SR.isGithubOwner(function(e){return Z(e)})},[]),(0,m.useEffect)(function(){if(_&&"private"===g)return clearInterval(ee.current),ee.current=setInterval(function(){ea()},18e4),function(){clearInterval(ee.current)}},[g,ea,_]),(0,m.useEffect)(function(){q((0,f.tq)())},[]),(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(x,w(w({},P),{},{children:[(0,v.jsx)("div",{className:"list_wrap",children:null==N?void 0:N.map(function(e,t){var n,r;return null!==(n=I[e.path])&&void 0!==n&&n.length?(0,v.jsxs)("div",{className:"time_fold_wrap".concat(z.current*A.current>t?"":" hide"),children:[(0,v.jsxs)("div",{className:"timestone",children:[S&&(0,v.jsx)("input",{type:"checkbox",className:"if_del_btn",onChange:function(t){$(t.target.checked?e.name:"")}}),e.name]}),(0,v.jsx)("div",{className:"pics_item_wrap",children:null===(r=I[e.path])||void 0===r?void 0:r.map(function(t,n){return(0,v.jsxs)("div",{className:"pic_item_wrap",style:{backgroundColor:eu(n)},children:[Q===e.name&&(0,v.jsx)(l.Z,{className:"img_del_btn",type:"close",onClick:function(){return eo(e.path,t)}}),(0,v.jsx)(s.Z,{className:"img_item",src:"https://wsrv.nl/?url=".concat((t.download_url||"").replace("https://","")).concat(T?"&w=80&h=180":"&w=300","&fit=cover&n=-1&q=80"),width:"130",height:"320",noReload:!0,onLoad:function(t){ei(e.path,n)},onClick:function(){return ec(I[e.path],n)}})]},t.name)})})]},e.path):""})}),(0,v.jsx)("div",{ref:Y,children:M||!N?(0,v.jsx)("div",{className:"no_more_tips",children:"真的一点都没有了。。。。。。"}):(0,v.jsx)(l.Z,{className:"load_more_sign rotate",width:"48",type:"loading",fill:"gray"})})]}))})})},7167:function(e,t,n){"use strict";n.d(t,{Is:function(){return m},P_:function(){return p},VD:function(){return o},Zb:function(){return f},iS:function(){return l},yJ:function(){return d}});var r,o,c=n(9499),a=n(842),i=n(8984);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){(0,c.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}(r=o||(o={})).PHOTO="photo",r.PRIVATE="private";var l=function(e){return(0,a.IO)({path:"/demos/uploadBase64",method:"put",headers:s({timestamp:Date.now(),"content-type":"application/json"},i.SR.data.token?{Authorization:"token ".concat(i.SR.data.token)}:{}),params:e})},p=function(e){return(0,a.IO)({path:"/demos/uploadUrl",method:"put",headers:s({timestamp:Date.now(),"content-type":"application/json"},i.SR.data.token?{Authorization:"token ".concat(i.SR.data.token)}:{}),params:e})},f=function(e,t){return(0,a.IO)({path:"/demos/queryPicList",method:"post",headers:s({"content-type":"application/json"},i.SR.data.token?{Authorization:"token ".concat(i.SR.data.token)}:{}),params:{path:e,mode:t}})},d=function(e,t){return(0,a.IO)({path:"/demos/queryPic",method:"post",headers:s({"content-type":"application/json"},i.SR.data.token?{Authorization:"token ".concat(i.SR.data.token)}:{}),params:{path:e,mode:t}})},m=function(e){return(0,a.IO)({path:"/demos/deletePic",method:"post",headers:s({timestamp:Date.now(),"content-type":"application/json"},i.SR.data.token?{Authorization:"token ".concat(i.SR.data.token)}:{}),params:e})}},8821:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/demos/imgSource/components/PicList",function(){return n(2561)}])}},function(e){e.O(0,[774,888,179],function(){return e(e.s=8821)}),_N_E=e.O()}]);